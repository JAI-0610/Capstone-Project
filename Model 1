import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

df = pd.read_csv("/content/dataset.csv")

df['Timestamp'] = pd.to_datetime(df['LastUpdatedDate'] + ' ' + df['LastUpdatedTime'], format='%d-%m-%Y %H:%M:%S')
df = df.sort_values(by=['SystemCodeNumber', 'Timestamp'])

df['OccupancyRate'] = df['Occupancy'] / df['Capacity']

base_price = 10.0
alpha = 2.0
df['BaselinePrice'] = base_price

for lot in df['SystemCodeNumber'].unique():
    lot_mask = df['SystemCodeNumber'] == lot
    lot_df = df.loc[lot_mask].copy()
    prices = [base_price]

    for i in range(1, len(lot_df)):
        prev_price = prices[-1]
        occ_rate = lot_df.iloc[i - 1]['OccupancyRate']
        next_price = prev_price + alpha * occ_rate
        next_price = max(base_price * 0.5, min(base_price * 2, next_price))
        prices.append(next_price)

    df.loc[lot_mask, 'BaselinePrice'] = prices

import matplotlib.dates as mdates

sample_lot = df['SystemCodeNumber'].unique()[0]
plot_df = df[df['SystemCodeNumber'] == sample_lot]

plt.figure(figsize=(12, 5))
plt.plot(plot_df['Timestamp'], plot_df['BaselinePrice'], label='Baseline Price')
plt.title(f'Price Trend â€“ Lot: {sample_lot}')
plt.xlabel("Time")
plt.ylabel("Price ($)")
plt.xticks(rotation=45)
plt.gca().xaxis.set_major_formatter(mdates.DateFormatter('%m-%d %H:%M'))
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()
